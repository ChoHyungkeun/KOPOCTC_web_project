<!doctype html>
<html lang="en">
<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">


    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <title>공공시설 예약현황</title>
</head>
<body>
<!-- header.html -->
<nav class="navbar navbar-expand-lg navbar-dark" style="background: linear-gradient(90deg, #005bac, #00a0e9); min-height: 56px; width: 100%;">
    <div class="d-flex justify-content-between align-items-center w-100 px-3">
        <a class="navbar-brand text-white mb-0" href="/">공공서비스예약</a>
        <div class="d-flex align-items-center">
            <a href="#" class="nav-link text-white px-3">로그인</a>
            <div class="nav-link text-white px-3" style="cursor: pointer;">KOR ▼</div>
        </div>
    </div>
</nav>

<ul class="nav nav-tabs bg-light justify-content-center" style="margin-bottom: 0;">
    <li class="nav-item">
        <a class="nav-link active" href="#">체육시설</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">공간시설</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">문화체험</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">교육강좌</a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="#">진료복지</a>
    </li>
</ul>
<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
    axios.interceptors.response.use(
      response => response,
      async error => {
        if (error.response && error.response.status === 401) {
          // 1. 클라이언트에 refreshToken 쿠키가 있는지 확인
          const hasRefreshToken = document.cookie.includes("refreshToken=");
          if (!hasRefreshToken) {
            // 로그인 안된 상태 → 곧장 로그인 페이지로
            window.location.href = '/login';
            return Promise.reject(error);
          }

          // 2. refreshToken이 존재하면 → 재발급 시도
          try {
            await axios.post('/reissue', null, { withCredentials: true });
            return axios(error.config); // 재요청
          } catch (reissueError) {
            // 재발급 실패 → 로그인 페이지로
            window.location.href = '/login';
          }
        }
        return Promise.reject(error);
      }
    );
</script>